<div class="feature-page">
  <mat-card class="profile-card">
    <div class="left-side">
      <input
        type="file"
        style="display: none"
        #imageInput
        (change)="selectPhoto($event)"
      />
      <div class="profile-image noselect">
        <img src="{{ getProfileImg(user.photo) }}" alt="" />
        <div class="profile-second-layer" (click)="onPhotoChange(imageInput)">
          <span>CHANGE PHOTO</span>
        </div>
      </div>
      <div class="info">
        <form class="column-form" [formGroup]="userFormGroup">
          <div class="fields">
            <mat-form-field>
              <mat-label>First name</mat-label>
              <input matInput formControlName="firstName" required />
            </mat-form-field>
            <mat-form-field>
              <mat-label>Last name</mat-label>
              <input matInput formControlName="lastName" required />
            </mat-form-field>
            <mat-form-field>
              <mat-label>Phone number</mat-label>
              <input
                type="tel"
                matInput
                placeholder="ex 40000000"
                formControlName="phone"
                required
              />
              <mat-icon matSuffix color="primary">smartphone</mat-icon>
            </mat-form-field>
          </div>
          <button
            [disabled]="isUserSaveButtonDisabled"
            mat-flat-button
            color="primary"
            class="material-button"
            (click)="openDialog('Save user')"
          >
            Save
            <mat-icon>save</mat-icon>
          </button>
        </form>
      </div>
    </div>
    <div class="right-side">
      <h3 class="info-label">
        Doctor's informations
        <span>
          <mat-icon
            color="primary"
            matTooltipPosition="above"
            matTooltip="To become a doctor, fill in the information below."
            >info_outline</mat-icon
          >
        </span>
      </h3>
      <form class="doctor-info-form" [formGroup]="doctorFormGroup">
        <mat-form-field>
          <mat-label>Specialty</mat-label>
          <mat-select formControlName="specialty" value="specialty" required>
            <mat-option
              *ngFor="let specialty of specialties"
              [value]="specialty"
            >
              {{ specialty }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix color="primary">task_alt</mat-icon>
          <mat-error *ngIf="doctorControls.specialty.invalid">
            {{
              doctorControls.specialty.errors.required
                ? "*Specialty is required."
                : ""
            }}
          </mat-error>
        </mat-form-field>
        <mat-form-field>
          <mat-label>Unique doctor identification code</mat-label>
          <input matInput formControlName="cuim" required />
          <mat-error *ngIf="doctorControls.cuim.invalid">
            {{
              doctorControls.cuim.errors.required ? "*CUIM is required." : ""
            }}
          </mat-error>
        </mat-form-field>
      </form>
      <button
        mat-flat-button
        color="primary"
        class="save-doctor-info-button"
        [disabled]="isDoctorInfoSaveButtonDisabled"
        (click)="openDialog('Save doctor')"
      >
        Save<mat-icon>save</mat-icon>
      </button>
      <div>
        <h3 class="info-label">
          Office informations
          <span>
            <mat-icon
              color="primary"
              matTooltipPosition="above"
              matTooltip="To join an office you must add one or accept an invitation to join."
              >info_outline</mat-icon
            >
          </span>
        </h3>

        <div class="office-information-container">
          <div class="office-left-side">
            <form [formGroup]="officeFormGroup" class="column-form">
              <mat-form-field>
                <mat-label>Address</mat-label>
                <input
                  matInput
                  formControlName="address"
                  [disabled]="!ownerCheck"
                  required
                  ngx-google-places-autocomplete
                  [options]="options"
                  #autocompleteRef
                  (onAddressChange)="handleAddressChange($event)"
                />
                <mat-error *ngIf="officeControls.address.invalid">
                  {{
                    officeControls.address.errors.required
                      ? "*Addreess is required."
                      : ""
                  }}
                </mat-error>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Name</mat-label>
                <input
                  matInput
                  formControlName="name"
                  [disabled]="!ownerCheck"
                  required
                />
                <mat-error *ngIf="officeControls.name.invalid">
                  {{
                    officeControls.name.errors.required
                      ? "*Office name is required."
                      : ""
                  }}
                </mat-error>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Longitude</mat-label>
                <input matInput formControlName="longitude" readonly required />
                <mat-error *ngIf="officeControls.longitude.invalid">
                  {{
                    officeControls.longitude.errors.required
                      ? "*Longitude is required."
                      : ""
                  }}
                </mat-error>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Latitude</mat-label>
                <input matInput formControlName="latitude" readonly required />
                <mat-error *ngIf="officeControls.latitude.invalid">
                  {{
                    officeControls.latitude.errors.required
                      ? "*Latitude is required."
                      : ""
                  }}
                </mat-error>
              </mat-form-field>
            </form>
          </div>
          <div class="office-right-side">
            <div class="agm-container">
              <agm-map
                [latitude]="officeFormGroup.value.latitude"
                [longitude]="officeFormGroup.value.longitude"
                [zoom]="16"
                #placesRef
              >
                <agm-marker
                  [latitude]="officeFormGroup.value.latitude"
                  [longitude]="officeFormGroup.value.longitude"
                ></agm-marker>
              </agm-map>
            </div>
          </div>
        </div>
        <div class="buttons-container">
          <button
            *ngIf="isOfficeAdded"
            mat-flat-button
            color="primary"
            class="material-button"
            (click)="openDialog('Remove office')"
          >
            Remove
            <mat-icon>delete_forever</mat-icon>
          </button>
          <button
            [disabled]="isSaveOfficeButtonDisabled"
            mat-flat-button
            color="primary"
            class="material-button"
            (click)="addOffice()"
          >
            Save
            <mat-icon>save</mat-icon>
          </button>
        </div>
        <div class="affiliated-doctors">
          <h3 class="info-label">Doctors</h3>
          <div class="doctors-list noselect" *ngIf="office && office.doctors">
            <div *ngFor="let d of office.doctors" class="doctor-wrapper" >
              <div class="doctor-container" >
                <img src={{getProfileImg(d.user.photo)}} [ngClass]="d.id === office.administratorId ? 'office-owner' : ''" >
                <div class="office-owner-shield" *ngIf="doctor.id === office.administratorId">
                  <mat-icon 
                  matTooltipPosition="below"
                  matTooltip="Administrator of the office." 
                  color="primary">health_and_safety</mat-icon>
                  
                </div>
              </div>
            </div>
            <div class="doctor-wrapper" *ngIf="doctor.id === office.administratorId">
              <div class="doctor-container">
                <div class="add-doctor" (click)="openDialog('Invite doctor')">
                  <mat-icon color="primary">add</mat-icon>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </mat-card>
</div>

<!-- <div class="feature-page">
    <div class="profile-info-wrapper">
        <mat-card class="profile-info-card">
            <input type="file" style="display:none;" #imageInput (change)="selectPhoto($event)">
            <div class="profile-image noselect">
                <img src={{profileImage}} alt="">
                <div class="profile-second-layer" (click)="onPhotoChange(imageInput)">
                  <span>CHANGE PHOTO</span>
                </div>
            </div>
            <div class="info">
                <form class="user-info-form" [formGroup]="userInfoFormGroup">
                  <div class="fields">
                    <mat-form-field>
                      <mat-label>First name</mat-label>
                      <input matInput formControlName="firstName" required>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-label>Last name</mat-label>
                      <input matInput formControlName="lastName" required>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-label>Cell phone</mat-label>
                      <input type="tel" matInput placeholder="ex 40000000" formControlName="phone" required>
                      <mat-icon matSuffix color="primary">smartphone</mat-icon>
                    </mat-form-field>
                  </div>
                    <button mat-flat-button color="primary" class="material-button">Save changes</button>
                </form>
            </div>
        </mat-card>
        <mat-card class="main-info-card">
          <div class="account-bedge">
            <span>Inactive doctor</span>
          </div>
          <form [formGroup]="mainInfoFormGroup" class="main-info-form">
            <div class="fields">
              <div class="right-side">

                <h3 class="info-label">
                  Doctor informations
                  <span>
                    <mat-icon color="primary">info_outline</mat-icon>
                  </span>
                </h3>
                <mat-form-field>
                  <mat-label>Speciality</mat-label>
                  <mat-select formControlName="specialty" required>
                    <mat-option *ngFor="let specialty of specialties" [value]="specialty">
                      {{ specialty }}
                    </mat-option>
                  </mat-select>
                  <mat-icon matSuffix color="primary">task_alt</mat-icon>
                </mat-form-field>
                <mat-form-field>
                  <mat-label>CUIM</mat-label>
                  <input matInput formControlName="cuim" required>
                </mat-form-field>
              </div>
            </div>
            <button mat-raised-button color="primary" class="material-button">Save changes</button>
          </form>
        </mat-card>
    </div>
    <div class="office">
      <mat-card class="office-card">
        <div class="office-card-buttons" *ngIf="!office">
          <button mat-raised-button color="primary" class="material-button office-card-button" (click)="onOpenAddOfficeDialog()">
            <mat-icon>add</mat-icon>
            Add office
          </button>
          <button mat-raised-button color="primary" class="material-button office-card-button" (click)="onOpenJoinOfficeDialog()">
            <mat-icon>add</mat-icon>
            Join an office
          </button>
        </div>
        <div class="office-card-content">
          <div class="no-offices-message" *ngIf="!office; else officeExist">
            <span>
              No office added 
            </span>
          </div>
          <ng-template #officeExist>
            <div class="details">
              <div class="edit-button" *ngIf="office.you.isOfficeOwner">
                <button mat-button class="material-button">
                  <mat-icon color="primary">save</mat-icon>
                </button>
              </div>
              <div class="content-container">
                <div class="office-map-location">
                  <div class="agm-container">
                    <agm-map [latitude]="officeDataFormGroup.value.latitude" [longitude]="officeDataFormGroup.value.longitude" style="width:100%;" [zoom]="16">
                      <agm-marker [latitude]="officeDataFormGroup.value.latitude" [longitude]="officeDataFormGroup.value.longitude"></agm-marker>
                    </agm-map>
                  </div>
                </div>

                <form [formGroup]="officeDataFormGroup" class="form-map-informations">
                  <mat-form-field>
                    <mat-label>Office name</mat-label>
                    <input matInput formControlName="officeName" required>
                    <mat-icon matSuffix color="primary">business_center</mat-icon>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Address</mat-label>
                    <mat-icon matSuffix color="primary">pin_drop</mat-icon>
                  </mat-form-field>


                </form>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
    </div>
</div> -->
