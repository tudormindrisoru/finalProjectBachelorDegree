<div class="feature-page">
    <div class="profile-info-wrapper">
        <mat-card class="profile-info-card">
            <input type="file" style="display:none;" #imageInput (change)="selectPhoto($event)">
            <div class="profile-image noselect">
                <img src={{profileImage}} alt="" >
                <div class="profile-second-layer" (click)="onPhotoChange(imageInput)">
                  <span>CHANGE PHOTO</span>
                </div>
            </div>
            <div class="info">
                <form class="important-info-form" [formGroup]="importantInfoFormGroup">
                  <div class="fields">
                    <mat-form-field>
                      <mat-label>First name</mat-label>
                      <input matInput placeholder="Ex. Popescu" formControlName="firstName" required>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-label>Last name</mat-label>
                      <input matInput placeholder="Ex. Alex" formControlName="lastName" required>
                    </mat-form-field>
                  </div>
                    <button mat-flat-button color="primary" class="material-button">Save changes</button>
                </form>
            </div>
        </mat-card>
        <mat-card class="main-info-card">
          <div class="account-bedge">
            <span>Inactive doctor</span>
          </div>
          <form [formGroup]="mainInfoFormGroup" class="main-info-form">
            <div class="fields">
              <div class="left-side">
                <h3 class="info-label">Basic informations 
                  <span>
                    <mat-icon color="primary">info_outline</mat-icon>
                  </span>
                </h3> 
                <mat-form-field>
                  <mat-label>Cell phone</mat-label>
                  <span matPrefix>+07 &nbsp;</span>
                  <input type="tel" matInput placeholder="ex 40000000" formControlName="cellPhone" required>
                  <mat-icon matSuffix color="primary">smartphone</mat-icon>
                </mat-form-field>
                
                <mat-form-field>
                  <mat-label>City</mat-label>
                  <mat-select formControlName="city" required>
                    <mat-option *ngFor="let city of cities" [value]="city">
                      {{ city }}
                    </mat-option>
                  </mat-select>
                  <mat-icon matSuffix color="primary">location_city</mat-icon>
                </mat-form-field>

                <mat-form-field>
                  <mat-label>Birth date</mat-label>
                  <input matInput [matDatepicker]="datepicker" formControlName="birthDate">
                  <mat-datepicker-toggle matSuffix [for]="datepicker" color="primary"></mat-datepicker-toggle>
                  <mat-datepicker #datepicker>
                    <mat-datepicker-actions>
                      <button mat-button matDatepickerCancel>Cancel</button>
                      <button mat-raised-button color="primary" matDatepickerApply>Apply</button>
                    </mat-datepicker-actions>
                  </mat-datepicker>
                </mat-form-field>
                </div>
              <div class="right-side">

                <h3 class="info-label">
                  Doctor informations
                  <span>
                    <mat-icon color="primary">info_outline</mat-icon>
                  </span>
                </h3>
                <mat-form-field>
                  <mat-label>Speciality</mat-label>
                  <mat-select formControlName="specialty" required>
                    <mat-option *ngFor="let specialty of specialties" [value]="specialty">
                      {{ specialty }}
                    </mat-option>
                  </mat-select>
                  <mat-icon matSuffix color="primary">task_alt</mat-icon>
                </mat-form-field>
                <mat-form-field>
                  <mat-label>CUIM</mat-label>
                  <input matInput formControlName="cuim" required>
                </mat-form-field>
              </div>
            </div>
            <button mat-raised-button color="primary" class="material-button">Save changes</button>
          </form>
        </mat-card>
    </div>
    <div class="office">
      <mat-card class="office-card">
        <div class="office-card-buttons" *ngIf="!office">
          <button mat-raised-button color="primary" class="material-button office-card-button" (click)="onOpenAddOfficeDialog()">
            <mat-icon>add</mat-icon>
            Add office
          </button>
          <button mat-raised-button color="primary" class="material-button office-card-button" (click)="onOpenJoinOfficeDialog()">
            <mat-icon>add</mat-icon>
            Join an office
          </button>
        </div>
        <div class="office-card-content">
          <div class="no-offices-message" *ngIf="!office; else officeExist">
            <span>
              No office added 
            </span>
          </div>
          <ng-template #officeExist>
            <div class="details">
              <div class="edit-button" *ngIf="office.you.isOfficeOwner">
                <button mat-button class="material-button">
                  <mat-icon color="primary">save</mat-icon>
                </button>
              </div>
              <div class="content-container">
                <div class="office-map-location">
                  <div class="agm-container">
                    <agm-map [latitude]="officeDataFormGroup.value.latitude" [longitude]="officeDataFormGroup.value.longitude" style="width:100%;" [zoom]="16">
                      <agm-marker [latitude]="officeDataFormGroup.value.latitude" [longitude]="officeDataFormGroup.value.longitude"></agm-marker>
                    </agm-map>
                  </div>
                </div>

                <form [formGroup]="officeDataFormGroup" class="form-map-informations">
                  <mat-form-field>
                    <mat-label>Office name</mat-label>
                    <input matInput formControlName="officeName" required>
                    <mat-icon matSuffix color="primary">business_center</mat-icon>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Address</mat-label>
                    <!-- <input matInput formControlName="officeAddress" ngx-google-places-autocomplete [options]="autocompleteOptions" #placesRef="ngx-places" (onAddressChange)="handleAddressChange($event)" -->
                           <!-- required> -->
                    <mat-icon matSuffix color="primary">pin_drop</mat-icon>
                  </mat-form-field>

                  <div class="affiliated-doctors">
                    <h3>Doctors</h3>
                    <div class="doctors-list noselect" formArrayName="doctors">
                      <div *ngFor="let doctor of officeDataFormGroup.get('doctors').controls; let i = index" class="doctor-wrapper">
                        <div [formGroupName]="i"  class="doctor-container" (click)="onOpenDoctorDetailDialog(i)">
                          <img src={{doctor.value.photo}} [ngClass]="doctor.value.isOfficeOwner ? 'office-owner' : ''" >
                          <div class="doctors-second-layer">
                            <span>{{ isYou(i) ? 'YOU' : 'OPEN' }}</span>
                          </div>
                          <div class="office-owner-shield" *ngIf="doctor.value.isOfficeOwner">
                            <mat-icon color="primary">health_and_safety</mat-icon>
                          </div>
                        </div>
                      </div>
                      <div class="doctor-wrapper" *ngIf="office.you.isOfficeOwner">
                        <div class="doctor-container" (click)="onOpenDoctorDetailDialog()">
                          <div class="add-doctor">
                            <mat-icon color="primary">add</mat-icon>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
    </div>
</div>